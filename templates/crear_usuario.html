<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="static/images/logosmall.ico">
    <title>R&R SIGN UP</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='stylemain.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

    <div class="navbar">
        <!-- Logo centrado -->
        <div class="nav-left">
            <span>&nbsp;</span>
            <a href="{{ url_for('home') }}" id="logo"><img src="static/images/logo_edited.png" style="height: 40px; filter: drop-shadow(0 0 8px rgba(0, 0, 0, .7));"></a>
        </div>
        
        <div class="nav-logo">
            <span></span>
        </div>
    
        <!-- Enlaces del lado derecho -->
        <div class="nav-right">
            <span>&nbsp;</span>
        </div>
    </div>
    <script>
        window.onbeforeunload = function() {
            // Limpiar los campos del formulario
            const form = document.getElementById('form-signup');
            if (form) {
                form.reset(); // Restablece todos los campos del formulario
            }
        };
    </script>
    <div class="login-container">
        <div class="login-box login-box2">
            <h1>Sign up</h1><br>
            <form id="form-signup" method="post" action="{{ url_for('login.new_user') }}">
                <div class="container_cols">
                    <div class="columna">
                        <div class="input-box">
                            <input type="text" name="name" required oninput="validarLetras(this), this.setCustomValidity('')" title="Enter your name" oninvalid="this.setCustomValidity('Please enter your name')" onclick="ocultaError()">
                            <label for="name">Name</label>
                        </div>
                        <div class="input-box">
                            <input type="text" name="lstname" required oninput="validarLetras(this), this.setCustomValidity('')" title="Enter your last name" oninvalid="this.setCustomValidity('Please enter your last name')" onclick="ocultaError()">
                            <label for="lstname">Last name</label>
                        </div>
                        <div class="input-box">
                            <input id="email" type="text" name="email" required oninput="validarCorreo(this)" title="Enter your email" oninvalid="this.setCustomValidity('Please enter your email')" onclick="ocultaError()">
                            <label for="email">Email</label>
                            <small id="message"></small>
                        </div>
                    </div>
                    <div class="columna">
                        <div class="input-box">
                            <input id="number" name="number" type="tel" required maxlength="10" oninput="validarNumeros(this), validarTelefono(this)" title="Enter your phone number" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('Please enter your phone number')" onclick="ocultaError()">
                            <label for="number">Phone Number</label>
                            <small id="message1"></small>
                        </div>
                        <div class="input-box">
                            <input type="text" name="id" maxlength="10" required title="Enter your ID" oninvalid="this.setCustomValidity('Please enter your ID')" oninput="this.setCustomValidity('')" onclick="ocultaError()">
                            <label for="id">Employee ID</label>
                        </div>
                        <div class="input-box">
                            <input type="password" name="password" required title="Enter your password" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('Please enter your password')">
                            <label for="password">Password</label>
                        </div>
                    </div>
                </div>
                <!-- Mensaje de error -->
                <p id="error_message"></p>
                <div class="button-box">
                    <button type="submit">Sign up</button>
                </div>
                <div class="links">
                    <a href="{{ url_for('login.login_route') }}">Already have an account? Sign in</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    {% include "shared/footer.html" %}
    <!-- Footer -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('form-signup');
            const errorMessage = document.getElementById('error_message');
    
            form.addEventListener('submit', function(event) {
                errorMessage.textContent = ''; // Limpiar el mensaje de error
                let errors = []; // Lista de errores
    
                const name = form.elements['name'].value.trim();
                const lastName = form.elements['lstname'].value.trim();
                const email = form.elements['email'].value.trim();
                const number = form.elements['number'].value.trim();
                const id = form.elements['id'].value.trim();
                const password = form.elements['password'].value.trim();
    
                // Validar campos vacíos
                if (!name) errors.push('Name is required.');
                if (!lastName) errors.push('Last name is required.');
                if (!email) errors.push('Email is required.');
                if (!number) errors.push('Phone number is required.');
                if (!id) errors.push('Employee ID is required.');
                if (!password) errors.push('Password is required.');
    
                // Validar formato de email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (email && !emailRegex.test(email)) {
                    errors.push('Email format is invalid.');
                }
    
                // Validar número de teléfono (10 dígitos)
                const phoneRegex = /^\d{10}$/;
                if (number && !phoneRegex.test(number)) {
                    errors.push('Phone number must be 10 digits.');
                }
    
                // Validar ID (opcional: solo números)
                if (id && isNaN(id)) {
                    errors.push('Employee ID must be numeric.');
                }
    
                // Validar contraseña
                const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
                if (password && !passwordRegex.test(password)) {
                    errors.push('Password must be at least 8 characters long, include an uppercase letter, a lowercase letter, a number, and a special character.');
                }
    
                // Mostrar errores si los hay
                if (errors.length > 0) {
                    event.preventDefault(); // Prevenir el envío del formulario
                    errorMessage.textContent = errors.join(' ');
                    errorMessage.style.color = 'red';
                }
            });
        });
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            manejarEnvioFormulario('form-signup', '/new_user'); // Llama a la función con el ID del formulario
        });
    </script>
    <script src="{{ url_for('static', filename='ventas.js') }}" ></script>
    <script src="{{ url_for('static', filename='app.js') }}" ></script>
    <script src="{{ url_for('static', filename='validations.js') }}" ></script>
</body>
</html>


